---
Comment: "Please note that Jekyll will only convert files that also have a YAML header at the top."
---


require 'prawn'
require 'date'


module Fengb
  class Resume < Prawn::Document
    module Primitives
      def fmt_date(date, default=nil)
        return Date.parse(date).strftime("%b '%y") if date
        raise if default.nil?
        default
      end

      def link(url, text)
        "<b><color rgb='435c96'><link href='#{url}'>#{text}</link></color></b>"
      end

      def nav(links)
        text links.map{|text, url| link(url, text)}.join('  •  '), inline_format: true, align: :center
      end

      def dl(options)
        move_up 1
        table_adjusted options.map{|cat, val| ["#{cat}:", val]}, cell_style: {borders: [], padding: [1, 0]} do
          column(0).style padding_right: 4
        end
        move_up 1
      end

      def ul(values, options={})
        move_up 1
        table_adjusted values.map{|e| ['•', e]}, cell_style: options.merge(borders: [], padding: [1, 0]) do
          column(0).style padding_left: 2, width: 10
        end
        move_up 1
      end

      # Table whitespace is off...
      def table_adjusted(*args, &block)
        move_up 2
        table *args, &block
        move_down 2
      end
    end

    module Sectioning
      def gutter
        8
      end

      def header(title)
        text title, align: :center, size: 18, style: :bold
        move_up 1
        font_size 11 do
          yield
        end
      end

      def section(title)
        move_down 1.5*gutter

        title_width = 128
        text_box title.upcase, at: [0, cursor - 1], width: (title_width - 2*gutter), align: :right, size: 16, style: :bold
        bounding_box([title_width, cursor], width: bounds.width - title_width) do
          move_down 1
          @locations = 0
          yield

          stroke do
            vertical_line bounds.top+2, bounds.bottom, at: -gutter
          end
        end
      end

      def location(name, url)
        if @locations != 0
          move_down gutter
        end
        @locations += 1

        text link(url, name), inline_format: true, size: 12
        @role = 0

        title_width = 10
        bounding_box([title_width, cursor], width: bounds.width - title_width) do
          yield
        end
      end

      def role(title, options)
        if @role == 0
          move_down gutter/4
        else
          move_down gutter/2
        end
        @role += 1

        table_adjusted [[title, fmt_date(options[:from]), '-', fmt_date(options[:to], 'present')]] do
          cells.style borders: [], padding: [3, 0, 0, 0], align: :right, inline_format: true, size: 8, font: 'Courier', font_style: :bold
          column(0).style align: :left, size: 10.5, padding: 0, font: 'Helvetica'
          self.column_widths = [320, 37, 8, 37]
        end

        move_down 1
        if options[:duties]
          ul(options[:duties], width: 300)
        end
      end
    end

    include Primitives, Sectioning
    def self.render(options={}, &block)
      pdf = new(options, &block)
      pdf.render
    end
  end
end

Fengb::Resume.render do
  font_size 10
  header 'Benjamin Feng' do
    nav('(312) 725-2842'     => 'tel:+1-312-725-2842',
        'contact@fengb.info' => 'mailto:contact@fengb.info')
  end

  section 'Objective' do
    text 'To solve intricate problems with emphasis on usability and maintainability.'
    text ' ', size: 3
  end

  section 'Skills' do
    dl(Languages:  'C, Javascript, Objective-C, Python, Ruby, SQL',
       Frameworks: 'Django, jQuery, Ruby on Rails',
       Versioning: 'Git, Mercurial, Perforce, Subversion')
  end

  section 'Employment' do
    location 'FENGB TECHNOLOGIES LLC', 'http://fengb.info' do
      role 'Independent Consultant',
        from: '2013-08-05'
    end

    location 'Enova International', 'http://www.enova.com' do
      role 'Lead Software Engineer',
        from: '2012-04-03',
        duties: ['Acted as technical team lead for 6 developers and 3 QA',
                 'Architected full-stack solutions for newly-launched product',
                 'Proposed and executed lean UX design processes']

      role 'Sr. Software Engineer II',
        from: '2011-07-01', to: '2012-04-02',
        duties: ['Drove high priority projects with aggressive deadlines',
                 'Promoted security initiatives to eliminate attack vectors',
                 'Onboarded newly hired developers and managers']

      role 'Sr. UI Engineer',
        from: '2010-07-01', to: '2011-06-30',
        duties: ['Updated the UI to maintain compliance with rapidly changing legal environments',
                 'Helped launch mobile web for all existing products']

      role 'UI Engineer',
        from: '2009-10-19', to: '2010-06-30',
        duties: ['Launched web solutions for products with millions of customers',
                 'Worked with business and creative teams to deliver customer focused designs']
    end

    location 'Crusader Storm (defunct)', 'http://web.archive.org/web/20100623115357/http://www.crusaderstorm.com/' do
      role 'Founder',
        from: '2010-05-07', to: '2011-05-06',
        duties: ['Incubated iPhone app from concept to release',
                 'Designed responsive website with graceful degradation']
    end

    location 'Business Logic Corporation', 'http://businesslogic.com/' do
      role 'Software Engineer',
        from: '2007-06-04', to: '2009-08-04',
        duties: ['Repurposed existing single-threaded engine into a massively scalable aggregator',
                 'Maintained legacy SOAP translation for a RESTful architecture',
                 'Created testing framework for separating data and verification']
    end

    location 'Rose-Hulman Ventures', 'http://rhventures.org/' do
      role 'Computer Engineering Intern',
        from: '2006-06-12', to: '2007-03-16',
        duties: ['Optimized chemical control software for space efficiency',
                 'Enhanced C++ MFC application integrating with embedded controls']

      role 'Software Engineering Intern',
        from: '2005-06-06', to: '2006-06-09',
        duties: ['Coordinated a development team of 5 to build a management website for doctors',
                 'Worked with business on defining requirements']
    end
  end

  section 'Education' do
    location 'Rose-Hulman Institute of Technology', 'http://www.rose-hulman.edu/' do
      role 'B.S. Computer Engineering',
        from: '2003-09-04', to: '2007-05-26',
        duties: ['Minors in Computer Science & Economics']
    end
  end
end
